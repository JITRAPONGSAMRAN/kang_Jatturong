<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>คำนวณค่าแรงรายวัน</title>
<script>
document.addEventListener("DOMContentLoaded", () => {
    const dailyWage = 600;
    const hoursPerDay = 8;
    const hourlyWage = dailyWage / hoursPerDay;
    const otRate = 1.5;
    const sundayRate = 2;

    const table = document.getElementById("workTable");
    const monthSelect = document.getElementById("monthSelect");
    const periodSelect = document.getElementById("periodSelect");
    const calcBtn = document.getElementById("calcBtn");
    const result = document.getElementById("result");

    const holidays = ["2025-06-20", "2025-06-28", "2025-07-04"]; // ตัวอย่างวันหยุดพิเศษ

    function generateTable(startDay, endDay, month, year) {
        table.innerHTML = "";
        for (let day = startDay; day <= endDay; day++) {
            const dateStr = `${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
            const date = new Date(dateStr);
            if (isNaN(date)) continue;

            const isSunday = date.getDay() === 0;
            const isHoliday = holidays.includes(dateStr);
            const row = document.createElement("tr");
            row.innerHTML = `
                <td>${dateStr}</td>
                <td><input type="number" min="0" max="8" value="8"></td>
                <td><input type="number" min="0" value="0"></td>
            `;
            if (isSunday || isHoliday) row.style.backgroundColor = "#f8d7da";
            table.appendChild(row);
        }
    }

    function updateTable() {
        const [year, month] = monthSelect.value.split("-").map(Number);
        if (periodSelect.value === "second") {
            generateTable(16, new Date(year, month, 0).getDate(), month, year);
        } else {
            generateTable(1, 15, month, year);
        }
    }

    monthSelect.onchange = updateTable;
    periodSelect.onchange = updateTable;

    calcBtn.onclick = () => {
        let totalNormal = 0, totalOT = 0;

        for (let row of table.rows) {
            const dateStr = row.cells[0].innerText;
            const date = new Date(dateStr);
            const normalHours = parseFloat(row.cells[1].querySelector("input").value) || 0;
            const otHours = parseFloat(row.cells[2].querySelector("input").value) || 0;
            const isSunday = date.getDay() === 0;
            const isHoliday = holidays.includes(dateStr);

            const wageNormal = (normalHours / hoursPerDay) * dailyWage;
            const wageOT = otHours * hourlyWage * (isSunday || isHoliday ? sundayRate : otRate);

            totalNormal += wageNormal;
            totalOT += wageOT;
        }

        const [year, month] = monthSelect.value.split("-").map(Number);
        let payDate;
        if (periodSelect.value === "second") {
            payDate = `5/${month + 1}/${year}`;
        } else {
            payDate = `20/${month}/${year}`;
        }

        result.innerHTML = `
            <h3>สรุปเงินเดือน (รับวันที่ ${payDate})</h3>
            <p>ค่าแรงปกติรวม: ${totalNormal.toFixed(2)} บาท</p>
            <p>ค่าแรง OT รวม: ${totalOT.toFixed(2)} บาท</p>
            <p><strong>รับสุทธิ: ${(totalNormal + totalOT).toFixed(2)} บาท</strong></p>
        `;
    };

    const today = new Date();
    const defaultMonth = `${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}`;
    monthSelect.value = defaultMonth;
    updateTable();
});
</script>
<style>
body {
    font-family: sans-serif;
    padding: 20px;
    max-width: 800px;
    margin: auto;
}
table, th, td {
    border: 1px solid #ddd;
    border-collapse: collapse;
}
th, td {
    padding: 8px;
}
input[type="number"] {
    width: 70px;
}
button, select {
    margin: 10px 5px;
    padding: 5px 10px;
}
tr:nth-child(even) {background: #f2f2f2;}
</style>
</head>
<body>
<h1>เว็บคำนวณค่าแรงรายวัน</h1>
<p>ฐานเงินเดือน 600 บาท/วัน (8 ชม.), OT 1.5 เท่า, วันอาทิตย์และวันหยุดพิเศษ 2 เท่า</p>

<label>เลือกเดือน: <input type="month" id="monthSelect"></label>
<label>
    งวดเงินเดือน:
    <select id="periodSelect">
        <option value="first">1 - 15 เงินออกวันที่ 20</option>
        <option value="second">16 - สิ้นเดือน เงินออกวันที่ 5 เดือนถัดไป</option>
    </select>
</label>

<table>
<thead>
<tr><th>วันที่</th><th>ชั่วโมงปกติ</th><th>OT (ชม.)</th></tr>
</thead>
<tbody id="workTable"></tbody>
</table>

<button id="calcBtn">คำนวณเงินเดือน</button>

<div id="result" style="margin-top:20px;"></div>

</body>
</html>
